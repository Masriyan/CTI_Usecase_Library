# Hunt for CVE Exploitation Attempts

## Metadata
- **Use Case ID:** THD-UC007
- **Category:** Threat Hunting & Detection
- **Difficulty:** Advanced
- **Estimated Time:** 4-5 hours
- **Last Updated:** 2025-12-30

## Description
Vulnerability exploitation is a primary method for initial access and privilege escalation in modern cyber attacks. While vulnerability management teams focus on patching known CVEs, threat hunters must proactively detect exploitation attempts—both against patched and unpatched systems—to identify active threats, zero-day attacks, and exposure windows before patches are deployed.

This use case demonstrates how to hunt for CVE exploitation activity by correlating vulnerability intelligence with network traffic, system logs, and endpoint telemetry. The workflow covers identifying exploitation signatures, detecting post-exploitation artifacts, and tracking exploitation campaigns targeting your environment.

## Objectives
By completing this use case, you will:
- Identify CVEs being actively exploited in the wild
- Detect exploitation attempts in network traffic and system logs
- Correlate vulnerability scans with actual exploitation activity
- Hunt for post-exploitation artifacts and indicators of compromise
- Build detection signatures for emerging exploit activity
- Prioritize remediation based on active threat intelligence

## Prerequisites

### Data Sources
- **Vulnerability Scan Data** - Nessus, Qualys, Rapid7 scan results
- **Network Traffic Logs** - IDS/IPS, WAF, firewall logs
- **Endpoint Logs** - EDR, system logs, application logs
- **Threat Intelligence Feeds** - CVE exploitation tracking, exploit database
- **Packet Captures** - For deep-dive analysis of suspected exploitation

### Tools & Platforms
- **SIEM** - Splunk, Elastic, Microsoft Sentinel
- **IDS/IPS** - Snort, Suricata with CVE-specific signatures
- **Vulnerability Scanners** - Nessus, Qualys, OpenVAS
- **Exploit Databases** - ExploitDB, Metasploit, Packet Storm
- **CVE Intelligence** - CISA KEV, VulnDB, NVD

### Required Skills
- Understanding of common vulnerability types (RCE, SQLi, XSS, etc.)
- Network traffic analysis and packet inspection
- Log analysis and pattern recognition
- Familiarity with exploitation techniques and post-exploitation TTPs
- Knowledge of MITRE ATT&CK framework

### Access Requirements
- Access to vulnerability scan results
- SIEM and IDS/IPS log query permissions
- EDR platform access for endpoint hunting
- Packet capture capabilities for investigation
- Ability to deploy detection signatures

## Step-by-Step Workflow

### Step 1: Identify High-Priority CVEs
**Objective:** Determine which CVEs pose the greatest risk to your environment

**Actions:**
1. Review CISA Known Exploited Vulnerabilities (KEV) catalog
2. Monitor threat intelligence for actively exploited CVEs
3. Cross-reference trending CVEs with asset inventory
4. Prioritize RCE and authentication bypass vulnerabilities
5. Track CVEs affecting internet-facing systems

**Example:**
```python
import requests

def get_cisa_kev():
    """Retrieve CISA KEV catalog"""
    url = "https://www.cisa.gov/sites/default/files/feeds/known_exploited_vulnerabilities.json"
    response = requests.get(url)

    if response.status_code == 200:
        kev_data = response.json()
        vulnerabilities = kev_data['vulnerabilities']

        # Filter for recent additions
        recent_kevs = [
            {
                'cve': v['cveID'],
                'vendor': v['vendorProject'],
                'product': v['product'],
                'description': v['shortDescription'],
                'date_added': v['dateAdded'],
                'due_date': v['dueDate']
            }
            for v in vulnerabilities
        ]

        return recent_kevs

    return None

# Check if we have vulnerable assets
def correlate_kev_with_assets(kev_list, vulnerability_scan_results):
    """Find KEV CVEs present in environment"""
    at_risk = []

    for kev in kev_list:
        for asset in vulnerability_scan_results:
            if kev['cve'] in asset.get('cves', []):
                at_risk.append({
                    'asset': asset['hostname'],
                    'ip': asset['ip'],
                    'cve': kev['cve'],
                    'product': kev['product'],
                    'severity': 'CRITICAL',
                    'actively_exploited': True
                })

    return at_risk
```

**Output:** Prioritized list of CVEs with active exploitation and environmental presence

---

### Step 2: Map Vulnerable Assets
**Objective:** Identify systems vulnerable to prioritized CVEs

**Actions:**
1. Query vulnerability scanners for affected systems
2. Identify internet-facing vs. internal vulnerable systems
3. Determine if vulnerable systems are patched or unpatched
4. Map system criticality and business impact
5. Create target list for hunting based on exposure

**Example:**
```sql
-- Query vulnerability management database
SELECT
    asset_name,
    ip_address,
    cve_id,
    cvss_score,
    exploitability,
    patch_status,
    exposure (internal/external)
FROM vulnerability_scan_results
WHERE cve_id IN ('CVE-2024-1234', 'CVE-2024-5678', ...)
    AND patch_status = 'unpatched'
    AND exposure = 'external'
ORDER BY cvss_score DESC, exploitability DESC
```

**Output:** Asset inventory of vulnerable systems prioritized by risk

---

### Step 3: Research Exploitation Signatures
**Objective:** Understand how each CVE is exploited to build detection logic

**Actions:**
1. Review CVE details from NVD and vendor advisories
2. Study public exploits from ExploitDB and Metasploit
3. Identify HTTP request patterns, payloads, or command signatures
4. Document exploitation indicators (URLs, headers, payloads, file paths)
5. Check for existing IDS signatures (Snort, Suricata rules)

**Example:**
```yaml
# Example: Log4Shell (CVE-2021-44228) exploitation patterns
cve: CVE-2021-44228
name: Apache Log4j RCE
exploitation_indicators:
  http_headers:
    - pattern: '${jndi:ldap://'
    - pattern: '${jndi:rmi://'
    - pattern: '${jndi:dns://'

  user_agents:
    - pattern: '${jndi:ldap://[a-z0-9.-]+/'

  url_parameters:
    - pattern: '.*\$\{jndi:(ldap|rmi|dns)://.*\}'

  post_exploitation:
    - outbound_ldap_connections: true
    - suspicious_java_processes: true
    - files_created: ['/tmp/exploit.class', '/tmp/payload.sh']

  detection_query: |
    index=web_logs
    | regex _raw="\$\{jndi:(ldap|rmi|dns)://.*\}"
    | stats count by src_ip, dest_ip, uri, user_agent
```

**Output:** Exploitation signature library for hunting queries

---

### Step 4: Network Traffic Analysis
**Objective:** Hunt for exploitation attempts in network logs

**Actions:**
1. Query WAF, IDS/IPS logs for CVE-specific patterns
2. Search web server logs for suspicious request patterns
3. Identify scanning activity targeting vulnerable endpoints
4. Look for exploit payloads in HTTP requests, headers, cookies
5. Detect post-exploitation network activity (reverse shells, C2)

**Example:**
```sql
-- Splunk query for CVE-2024-XXXX exploitation (SQL injection)
index=waf_logs OR index=web_logs
| search uri="*/vulnerable-endpoint*"
| regex uri="(UNION|SELECT|INSERT|DROP|--|;|'|\")"
| eval sql_injection_score = case(
    like(uri, "%UNION%SELECT%"), 30,
    like(uri, "%' OR '1'='1%"), 25,
    like(uri, "%';--"), 20,
    1=1, 0
  )
| where sql_injection_score > 20
| stats count, values(uri), values(user_agent)
  by src_ip, dest_ip, sql_injection_score
| sort -sql_injection_score
```

**Output:** Network-based exploitation attempts with source IPs and patterns

---

### Step 5: Endpoint Telemetry Hunting
**Objective:** Search endpoint logs for post-exploitation artifacts

**Actions:**
1. Query EDR for suspicious process execution on vulnerable hosts
2. Look for file creation/modification in exploit-related paths
3. Detect privilege escalation attempts following vulnerability timeline
4. Identify lateral movement from vulnerable systems
5. Search for credential dumping or persistence mechanisms

**Example:**
```sql
-- EDR query for post-exploitation activity
index=edr host IN (vulnerable_asset_list)
| search (
    (process_name="cmd.exe" OR process_name="powershell.exe")
    AND parent_process_name="java.exe"
  ) OR (
    file_path="/tmp/*" AND file_created=true
  ) OR (
    process_name="whoami" OR process_name="net.exe"
  )
| eval post_exploit_indicator = case(
    process_name="whoami", "reconnaissance",
    process_name="net.exe", "enumeration",
    like(command_line, "%mimikatz%"), "credential_access",
    like(file_path, "/tmp/%"), "staging",
    1=1, "unknown"
  )
| stats count by host, process_name, command_line, post_exploit_indicator, _time
| sort -_time
```

**Output:** Endpoint-based indicators of successful exploitation

---

### Step 6: Timeline Analysis
**Objective:** Correlate exploitation attempts with CVE disclosure and patch timelines

**Actions:**
1. Map exploitation attempts to CVE disclosure date
2. Identify 0-day exploitation (attempts before public disclosure)
3. Track exploitation velocity after public exploit release
4. Correlate with organizational patching timeline
5. Identify window of exposure and potential compromise

**Example:**
```python
from datetime import datetime, timedelta

def analyze_exploitation_timeline(cve_data, log_events):
    """Analyze exploitation timing relative to CVE lifecycle"""

    cve_disclosed = datetime.strptime(cve_data['disclosure_date'], '%Y-%m-%d')
    exploit_published = datetime.strptime(cve_data['exploit_published'], '%Y-%m-%d')
    patch_available = datetime.strptime(cve_data['patch_date'], '%Y-%m-%d')
    patch_deployed = datetime.strptime(cve_data['org_patch_date'], '%Y-%m-%d')

    timeline = {
        'cve': cve_data['cve_id'],
        'zero_day_attempts': 0,
        'pre_patch_attempts': 0,
        'post_patch_attempts': 0,
        'exposure_window_days': (patch_deployed - cve_disclosed).days
    }

    for event in log_events:
        event_time = event['timestamp']

        if event_time < cve_disclosed:
            timeline['zero_day_attempts'] += 1
        elif event_time < patch_deployed:
            timeline['pre_patch_attempts'] += 1
        else:
            timeline['post_patch_attempts'] += 1

    return timeline
```

**Output:** Timeline showing exploitation attempts across CVE lifecycle

---

### Step 7: Threat Actor Attribution
**Objective:** Link exploitation activity to known threat actors or campaigns

**Actions:**
1. Correlate attacker IPs with threat intelligence
2. Analyze exploitation tools and techniques for actor TTPs
3. Check for campaign-specific indicators (custom payloads, infrastructure)
4. Review threat reports for CVE-specific campaigns
5. Identify mass scanning vs. targeted exploitation

**Example:**
```python
def attribute_exploitation_activity(attacker_ips, exploit_payloads):
    """Attempt to attribute exploitation to threat actors"""

    attributions = []

    for ip in attacker_ips:
        # Query threat intelligence
        ti_data = threat_intel_platform.lookup_ip(ip)

        if ti_data:
            attributions.append({
                'attacker_ip': ip,
                'threat_actor': ti_data.get('actor', 'Unknown'),
                'campaigns': ti_data.get('campaigns', []),
                'malware_families': ti_data.get('malware', []),
                'confidence': ti_data.get('confidence', 'low')
            })

    # Analyze payload patterns
    for payload in exploit_payloads:
        # Check for known malware families
        if 'mirai' in payload.lower():
            attributions.append({
                'malware_family': 'Mirai',
                'target': 'IoT devices',
                'motivation': 'botnet recruitment'
            })

    return attributions
```

**Output:** Attribution assessment linking activity to threat actors

---

### Step 8: Vulnerability-Exploit Correlation
**Objective:** Confirm successful exploitation vs. failed attempts

**Actions:**
1. Correlate exploitation attempts with system compromise indicators
2. Check for successful authentication after exploitation attempts
3. Look for data exfiltration following exploitation
4. Identify if exploitation led to malware deployment
5. Determine true positive vs. blocked/failed exploitation

**Example:**
```sql
-- Correlate WAF blocks with EDR events
index=waf_logs action=blocked cve_tag="CVE-2024-*"
| join src_ip [
    search index=edr
    | where _time > relative_time(now(), "-1h")
  ]
| eval exploitation_result = case(
    isnotnull(malware_detected), "successful_with_malware",
    isnotnull(suspicious_process), "potentially_successful",
    action="blocked", "blocked_by_waf",
    1=1, "unknown"
  )
| stats count by src_ip, dest_ip, cve_tag, exploitation_result
```

**Output:** Confirmed successful exploitations requiring incident response

---

### Step 9: Detection Rule Creation
**Objective:** Build production detection rules for ongoing monitoring

**Actions:**
1. Create IDS/IPS signatures for network-based exploitation
2. Develop EDR behavioral rules for post-exploitation activity
3. Write SIEM correlation rules combining multiple indicators
4. Build vulnerability-specific hunting queries
5. Test detection rules against historical data and red team exercises

**Example:**
```yaml
# Suricata rule for CVE-2024-XXXX
alert http any any -> $HOME_NET any (
  msg:"Possible CVE-2024-XXXX Exploitation Attempt";
  flow:established,to_server;
  content:"POST";
  http_method;
  content:"/vulnerable-endpoint";
  http_uri;
  pcre:"/(\$\{jndi|eval\(|cmd=|exec\()/i";
  reference:cve,2024-XXXX;
  classtype:attempted-admin;
  sid:1000001;
  rev:1;
)

# SIEM correlation rule
name: "CVE-2024-XXXX Exploitation and Post-Compromise"
description: "Detects exploitation attempt followed by suspicious activity"
severity: critical

trigger:
  - waf_block: cve="CVE-2024-XXXX" (within 5 minutes)
  - edr_alert: suspicious_process on same host (within 1 hour)

correlation:
  time_window: 1 hour
  group_by: [dest_ip, host]

action:
  - create_high_priority_alert
  - isolate_endpoint (if edr_alert present)
  - notify_security_team
```

**Output:** Production-ready detection rules deployed to security controls

---

### Step 10: Remediation and Reporting
**Objective:** Document findings and coordinate remediation efforts

**Actions:**
1. Create incident tickets for confirmed exploitation
2. Coordinate emergency patching for actively exploited CVEs
3. Implement virtual patching (WAF rules) for unpatched systems
4. Generate intelligence report on exploitation campaign
5. Share findings with vulnerability management and IT operations

**Example:**
```markdown
# CVE Exploitation Hunt Results

## Executive Summary
Hunting campaign detected active exploitation attempts targeting CVE-2024-XXXX
across 47 internet-facing systems. 12 exploitation attempts detected, 11
blocked by WAF, 1 potentially successful requiring investigation.

## Key Findings
- CVE: CVE-2024-XXXX (Apache Struts RCE)
- Vulnerable Assets: 47 systems
- Exploitation Attempts: 12 unique source IPs
- Successful Exploitations: 1 (under investigation)
- Threat Actor: APT28 (medium confidence)

## Timeline
- 2024-12-15: CVE disclosed
- 2024-12-16: Public exploit released
- 2024-12-16 14:00: First exploitation attempt detected
- 2024-12-17: Patch deployed to 40/47 systems
- 2024-12-18: Virtual patching deployed to remaining 7 systems

## Recommendations
1. Complete emergency patching of remaining 7 systems
2. Investigate potentially compromised system (APP-SERVER-07)
3. Maintain WAF rules as defense-in-depth
4. Deploy EDR detection rules for post-exploitation activity
5. Conduct lessons learned on patch deployment velocity
```

**Output:** Comprehensive report with remediation tracking

---

## Recommended CTI Products

### Primary Products
- **Tenable.io** - Vulnerability management with exploitation intelligence
  - Assessment: [Tenable](https://github.com/Masriyan/CTI-Product-Assesment-Matrix#tenable)
  - Key Features: Vulnerability prioritization, exploit prediction, threat intelligence integration

- **Rapid7 InsightVM** - Vulnerability and exploitation risk management
  - Assessment: [Rapid7](https://github.com/Masriyan/CTI-Product-Assesment-Matrix#rapid7)
  - Key Features: Exploit exposure, remediation prioritization, threat intelligence

### Alternative/Complementary Products
- **Qualys VMDR** - Vulnerability detection and response
  - Assessment: [Qualys](https://github.com/Masriyan/CTI-Product-Assesment-Matrix#qualys)

- **RecordedFuture** - Threat intelligence for CVE exploitation tracking
  - Assessment: [Recorded Future](https://github.com/Masriyan/CTI-Product-Assesment-Matrix#recorded-future)

- **Palo Alto Cortex XSOAR** - SOAR for automated CVE response
  - Assessment: [Cortex XSOAR](https://github.com/Masriyan/CTI-Product-Assesment-Matrix#palo-alto-cortex-xsoar)

### Open Source Options
- **CISA KEV Catalog** - Known exploited vulnerabilities list
- **OpenVAS** - Open-source vulnerability scanner
- **Suricata** - Open-source IDS/IPS with CVE signatures
- **ExploitDB** - Public exploit database

## Expected Outputs

### Deliverables
1. **Exploitation Hunt Report**
   - Format: PDF with technical and executive summaries
   - Content: CVEs hunted, exploitation attempts detected, confirmed compromises
   - Audience: Security leadership, vulnerability management, IR team

2. **Detection Rules Package**
   - Format: IDS signatures, EDR rules, SIEM queries
   - Content: Network and endpoint detection logic for CVE exploitation
   - Audience: SOC analysts, detection engineers

3. **Remediation Tracking**
   - Format: Spreadsheet or ticketing system
   - Content: Vulnerable assets, patch status, mitigation controls
   - Audience: IT operations, patch management, asset owners

4. **IOC Package**
   - Format: STIX 2.1, CSV
   - Content: Attacker IPs, payloads, compromised hosts
   - Audience: Threat hunters, SOC, SIEM ingestion

### Sample Output
```json
{
  "cve_exploitation_hunt": {
    "hunt_date": "2025-12-30",
    "cves_hunted": ["CVE-2024-1234", "CVE-2024-5678"],
    "vulnerable_assets": 47,
    "exploitation_attempts_detected": 12,
    "confirmed_successful": 1,
    "blocked_by_controls": 11,
    "detections": [
      {
        "cve": "CVE-2024-1234",
        "target_asset": "APP-SERVER-07",
        "target_ip": "10.50.30.142",
        "attacker_ip": "185.220.101.45",
        "timestamp": "2024-12-16T14:23:11Z",
        "exploitation_method": "HTTP POST with malicious payload",
        "waf_action": "allowed",
        "edr_detection": "suspicious Java process execution",
        "confidence": "high",
        "status": "under_investigation"
      }
    ],
    "threat_intelligence": {
      "attributed_actor": "APT28",
      "confidence": "medium",
      "campaign": "CVE-2024-1234 Mass Exploitation"
    },
    "remediation_actions": [
      "Emergency patching deployed to 40/47 systems",
      "Virtual patching (WAF rules) for 7 unpatched systems",
      "Incident INC-98765 opened for potentially compromised system",
      "Detection rules deployed to EDR and IDS"
    ]
  }
}
```

## Success Metrics
- Detection coverage: 90%+ of CISA KEV CVEs present in environment
- Detection speed: Identify exploitation within 1 hour of attempt
- False positive rate: <5% of exploitation alerts
- Remediation velocity: Emergency patching within 24 hours of detection
- Zero-day detection: Baseline behavioral detection for unknown exploits

## Tips & Best Practices

### General Tips
- Prioritize CVEs with known exploits and active campaigns (CISA KEV, EPSS scores)
- Focus hunting on internet-facing systems first (highest risk)
- Combine vulnerability data with threat intelligence for context
- Don't just hunt for successful exploitation—blocked attempts reveal targeting
- Correlate exploitation attempts with patch deployment timelines

### Common Pitfalls to Avoid
- **Scanner noise confusion**: Vulnerability scanners create traffic similar to exploitation; filter by source
- **Missing encoded payloads**: Exploits use encoding (base64, URL encoding); decode before pattern matching
- **Focusing only on RCE**: Auth bypass, SQLi, and path traversal also lead to compromise
- **Ignoring failed attempts**: Failed exploitation today may succeed tomorrow if unpatched

### Optimization Strategies
- Build CVE-specific detection libraries for rapid deployment
- Automate vulnerability scan correlation with exploitation intelligence
- Use virtual patching (WAF rules) to buy time during patch windows
- Implement behavioral detection for exploit techniques, not just CVE-specific signatures
- Leverage threat intelligence feeds for zero-day indicators

### Automation Opportunities
- Automated daily correlation of KEV catalog with vulnerability scans
- SOAR playbooks for emergency patching workflows
- Automatic deployment of IDS signatures for newly disclosed CVEs
- Integration of exploitation detection with patch prioritization
- Automated IOC extraction from exploitation attempts

## Real-World Application

### Industry Examples
- **Financial Services:** Bank detects and blocks Citrix CVE exploitation before breach
- **Healthcare:** Hospital identifies ransomware leveraging Zerologon (CVE-2020-1472)
- **Technology:** SaaS provider discovers zero-day exploitation through behavioral hunting
- **Government:** Agency prevents espionage via ProxyLogon (CVE-2021-26855) exploitation

### Case Study
A global manufacturing company implemented proactive CVE exploitation hunting after repeated incidents:

**Scenario:**
CVE-2024-XXXX disclosed on December 15 affecting Apache Struts. Public exploit released December 16. Company had 47 vulnerable internet-facing systems.

**Hunt Results:**
- December 16, 14:00: First exploitation attempt detected via WAF logs
- Next 48 hours: 12 total exploitation attempts from 8 unique IPs
- Threat intelligence: Attributed to APT28 mass exploitation campaign
- 11 attempts blocked by WAF
- 1 attempt potentially successful (WAF bypass using encoding variant)

**Response:**
1. Emergency patch deployed to critical systems within 12 hours
2. Virtual patching (WAF rules) deployed immediately for remaining systems
3. Potentially compromised system isolated and forensically analyzed
4. EDR detection rules deployed organization-wide

**Outcome:**
- Forensics confirmed NO successful compromise (post-exploitation activity was benign admin action)
- All systems patched within 72 hours (vs. normal 30-day patch cycle)
- Detection rules prevented 40+ additional exploitation attempts over following 2 weeks
- Lessons learned improved patch velocity for future critical CVEs

The proactive hunting approach detected exploitation attempts within hours of public disclosure, enabling emergency response that prevented what could have been a significant breach.

## Additional Resources

### Documentation
- [CISA Known Exploited Vulnerabilities Catalog](https://www.cisa.gov/known-exploited-vulnerabilities-catalog)
- [MITRE ATT&CK: Exploit Public-Facing Application (T1190)](https://attack.mitre.org/techniques/T1190/)
- [NVD - National Vulnerability Database](https://nvd.nist.gov/)
- [EPSS - Exploit Prediction Scoring System](https://www.first.org/epss/)

### Training Materials
- SANS SEC460: Enterprise Threat and Vulnerability Assessment
- "CVE Exploitation Detection" webinars
- Vulnerability management certifications

### Community Resources
- Twitter: #CVE, #vulnerabilitymanagement, #threatintel
- Reddit: r/netsec, r/blueteam
- Exploit Database community
- CVE mailing lists

## Related Use Cases
- [UC001: Hunt for Ransomware Using File Hash Pivoting](UC001-hunt-ransomware-file-hash-pivoting.md) - Malware delivered via exploits
- [UC008: Track Malware Distribution Infrastructure](UC008-track-malware-distribution-infrastructure.md) - Post-exploitation payload delivery
- [Vulnerability Intelligence UC002: Track Zero-Day Exploitation in the Wild](../vulnerability-intelligence/UC002-track-zero-day-exploitation-wild.md) - Zero-day detection

## Version History
| Version | Date | Author | Changes |
|---------|------|--------|---------|
| 1.0 | 2025-12-30 | CTI Team | Initial creation |

---

## Appendix

### Glossary
- **CVE (Common Vulnerabilities and Exposures)**: Unique identifier for publicly known security vulnerabilities
- **RCE (Remote Code Execution)**: Vulnerability allowing attacker to execute code remotely
- **CVSS (Common Vulnerability Scoring System)**: Standard for assessing vulnerability severity
- **KEV (Known Exploited Vulnerabilities)**: CISA catalog of actively exploited CVEs
- **EPSS (Exploit Prediction Scoring System)**: Probability score for CVE exploitation
- **Virtual Patching**: WAF/IPS rules providing temporary protection until patches deployed

### Sample Queries/Scripts
```python
#!/usr/bin/env python3
"""
CVE Exploitation Hunter
"""

import requests
from datetime import datetime, timedelta

class CVEExploitationHunter:
    def __init__(self, siem_client, vuln_scanner):
        self.siem = siem_client
        self.vuln_scanner = vuln_scanner

    def get_high_priority_cves(self):
        """Get CVEs from CISA KEV catalog"""
        url = "https://www.cisa.gov/sites/default/files/feeds/known_exploited_vulnerabilities.json"
        response = requests.get(url)

        if response.status_code == 200:
            data = response.json()
            # Filter for recent additions
            recent_date = datetime.now() - timedelta(days=30)
            recent_kevs = [
                v for v in data['vulnerabilities']
                if datetime.strptime(v['dateAdded'], '%Y-%m-%d') > recent_date
            ]
            return recent_kevs

        return []

    def find_vulnerable_assets(self, cve_list):
        """Query vulnerability scanner for affected assets"""
        vulnerable_assets = []

        for cve in cve_list:
            assets = self.vuln_scanner.query(f"cve:{cve['cveID']}")
            vulnerable_assets.extend(assets)

        return vulnerable_assets

    def hunt_exploitation_attempts(self, cve_id, vulnerable_assets):
        """Hunt for exploitation attempts in SIEM"""
        # Build list of vulnerable asset IPs
        asset_ips = [a['ip'] for a in vulnerable_assets]

        # Query SIEM for suspicious activity
        query = f"""
        index=waf OR index=ids
        dest_ip IN ({','.join(asset_ips)})
        AND (cve_tag={cve_id} OR payload="*exploit*")
        """

        results = self.siem.search(query)
        return results

    def correlate_with_endpoint_data(self, network_detections):
        """Correlate network exploitation with endpoint activity"""
        confirmations = []

        for detection in network_detections:
            # Query EDR for post-exploitation activity
            edr_query = f"""
            host={detection['dest_ip']}
            timestamp > {detection['timestamp']}
            (suspicious_process OR malware_detected)
            """

            edr_results = self.siem.search(edr_query, index="edr")

            if edr_results:
                confirmations.append({
                    'network_detection': detection,
                    'endpoint_activity': edr_results,
                    'confidence': 'high',
                    'status': 'confirmed_exploitation'
                })

        return confirmations

# Usage
hunter = CVEExploitationHunter(siem_client, vuln_scanner)
high_priority_cves = hunter.get_high_priority_cves()
vulnerable_assets = hunter.find_vulnerable_assets(high_priority_cves)
exploitation_attempts = hunter.hunt_exploitation_attempts(
    "CVE-2024-1234",
    vulnerable_assets
)
```

### Workflow Diagram
```
┌────────────────────────────────────────────────────────────┐
│          CVE Exploitation Hunting Workflow                 │
└────────────────────────────────────────────────────────────┘

    [CVE Intelligence]
    (CISA KEV, NVD, TI)
         │
         ▼
    ┌─────────────────────┐
    │ 1. Identify High-   │ ──────► Prioritize by exploit intel
    │    Priority CVEs    │
    └─────────────────────┘
         │
         ▼
    ┌─────────────────────┐
    │ 2. Map Vulnerable   │ ──────► Vulnerability scans
    │    Assets           │
    └─────────────────────┘
         │
         ▼
    ┌─────────────────────┐
    │ 3. Research Exploit │ ──────► Signatures & payloads
    │    Signatures       │
    └─────────────────────┘
         │
         ▼
    ┌─────────────────────┐
    │ 4. Network Traffic  │ ──────► WAF, IDS/IPS logs
    │    Analysis         │
    └─────────────────────┘
         │
         ▼
    ┌─────────────────────┐
    │ 5. Endpoint Hunting │ ──────► EDR post-exploitation
    └─────────────────────┘
         │
         ▼
    ┌─────────────────────┐
    │ 6. Timeline Analysis│ ──────► CVE lifecycle correlation
    └─────────────────────┘
         │
         ▼
    ┌─────────────────────┐
    │ 7. Threat Actor     │ ──────► Attribution
    │    Attribution      │
    └─────────────────────┘
         │
         ▼
    ┌─────────────────────┐
    │ 8. Vulnerability-   │ ──────► Confirm success/failure
    │    Exploit Correlation
    └─────────────────────┘
         │
         ▼
    ┌─────────────────────┐
    │ 9. Detection Rules  │ ──────► IDS, EDR, SIEM
    └─────────────────────┘
         │
         ▼
    ┌─────────────────────┐
    │ 10. Remediation &   │ ──────► Patching, reporting
    │     Reporting       │
    └─────────────────────┘
         │
         ▼
    [Confirmed Exploits + Detection Rules + Remediation]
```
